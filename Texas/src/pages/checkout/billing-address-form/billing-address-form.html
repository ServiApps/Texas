<ion-header>
<ion-navbar color="shadow">
  <button ion-button menuToggle>
    <ion-icon name="menu"></ion-icon>
  </button>
  <ion-title text-wrap  text-center style="font-family: Arial">Checkout</ion-title>

</ion-navbar>
</ion-header>

<ion-content text-wrap class="billing-address-form">

<div class="margin">

  <ion-item *ngIf="!values.isLoggedIn" style=" background-color:#f2f2f2;margin-bottom: 16px" no-lines>
    <ion-label style="font-size: 15px;color: #bf4080;">Returning customer? Login here..  <ion-icon ios="ios-log-in" md="md-log-in"></ion-icon></ion-label>
    <ion-toggle checked="true" [(ngModel)]="form.islogin" name="subscribe"></ion-toggle>
  </ion-item>

<div *ngIf="form.islogin" class="login-form">
<form #f="ngForm">
<ion-list>
  <ion-item>
    <ion-label floating>user name</ion-label>
    <ion-input required type="email" [(ngModel)]="form.username"  name="firstname"></ion-input>
  </ion-item>
  <ion-item>
    <ion-label floating>password</ion-label>
    <ion-input required type="password" [(ngModel)]="form.password" name="password"></ion-input>
  </ion-item>
</ion-list>
 <button ion-button block color="shadow" type="submit" [disabled]="buttonSubmitLogin" (click)="login(loginData)">{{buttonText2}}</button>
 </form>
 </div>

  <div *ngIf="!form.discount_cart">
  <ion-item *ngIf="form" style=" background-color:#f2f2f2;margin-bottom:16px" no-lines>
    <ion-label style="font-size: 15px;color: #bf4080;">Have a coupon? Enter code here.. <ion-icon ios="ios-card" md="md-card"></ion-icon></ion-label>
    <ion-toggle checked="true" [(ngModel)]="form.iscoupon" name="subscribe"></ion-toggle>
  </ion-item>
  </div>
  




<div *ngIf="form.iscoupon" class="coupon">
<form #f="ngForm">
  <ion-item>
    <ion-label floating>{{values.lan.GiftCardPromo}}</ion-label>
    <ion-input required type="text" [(ngModel)]="form.coupon_code" name="coupon"></ion-input>
  </ion-item>
    <button ion-button color="shadow" block type="submit" [disabled]="buttonSubmitCoupon" (click)="submitCoupon()"> {{buttonText1}}</button>
    
  
</form>
</div>  



<div *ngIf="form">
<form #f="ngForm" class="form">
  
  <ion-list no-margin>

  <ion-item style=" background-color:#f2f2f2">
  <ion-label style="font-size: 15px;color: #bf4080;">Billing Address</ion-label>
  </ion-item>

  <ion-item>
    <ion-label floating>{{form.checkout_fields.billing.billing_first_name.label}}</ion-label>
    <ion-input required type="text" [(ngModel)]="form.billing_first_name" name="firstname"></ion-input>
  </ion-item>

  <ion-item>
    <ion-label floating>{{form.checkout_fields.billing.billing_last_name.label}}</ion-label>
    <ion-input required type="text" [(ngModel)]="form.billing_last_name" name="lastname"></ion-input>
  </ion-item>

  <ion-item>
    <ion-label floating>{{form.checkout_fields.billing.billing_company.label}}</ion-label>
    <ion-input required type="text" [(ngModel)]="form.billing_company" name="company"></ion-input>
  </ion-item>

  <ion-item>
    <ion-label floating>{{form.checkout_fields.billing.billing_phone.label}}</ion-label>
    <ion-input required type="number" [(ngModel)]="form.billing_phone" name="telephone"></ion-input>
  </ion-item>
  
  <ion-item>
    <ion-label floating>{{form.checkout_fields.billing.billing_address_1.placeholder}}</ion-label>
    <ion-input required type="text" [(ngModel)]="form.billing_address_1" name="street1"></ion-input>
  </ion-item>

  <ion-item>
    <ion-label floating>{{form.checkout_fields.billing.billing_address_2.placeholder}}</ion-label>
    <ion-input required type="text" [(ngModel)]="form.billing_address_2" name="street2"></ion-input>
  </ion-item>

  <ion-item>
    <ion-label floating>{{form.checkout_fields.billing.billing_email.label}}</ion-label>
    <ion-input required type="email" [(ngModel)]="form.billing_email" name="email"></ion-input>
  </ion-item>


  <ion-item>
    <ion-label floating>{{form.checkout_fields.billing.billing_city.label}}</ion-label>
    <ion-input required type="text" [(ngModel)]="form.billing_city" name="city"></ion-input>
  </ion-item>

   <ion-item>
    <ion-label floating>{{form.checkout_fields.billing.billing_postcode.label}}</ion-label>
    <ion-input required type="number" [(ngModel)]="form.billing_postcode" name="postcode"></ion-input>
  </ion-item>


  <ion-item>
         
         <ion-label>  
               Country
         </ion-label>   
            <ion-select [(ngModel)]="form.billing_country" (ngModelChange)="getRegion(form.billing_country)" name="billing_country">
               <div *ngFor="let field of form.country.countries | keys">
               <ion-option value="{{field.key}}">{{field.value}}</ion-option>
               </div>
            </ion-select>
      
  </ion-item>

  <ion-item *ngIf="states">
         
         <ion-label>  
               state
         </ion-label>   
            <ion-select [(ngModel)]="form.billing_state" name="form.billing_state">
               <div *ngFor="let field of states | keys">
               <ion-option value="{{field.key}}">{{field.value}}</ion-option>
               </div>
            </ion-select>
      
  </ion-item>

  <ion-item *ngIf="!states">
    <ion-label floating>{{form.checkout_fields.billing.billing_state.label}}</ion-label>
    <ion-input required type="text" [(ngModel)]="form.billing_state" name="form.billing_state"></ion-input>
  </ion-item>
 
 </ion-list>
</form>
</div>


  <ion-item *ngIf="!values.isLoggedIn" style="background-color:#f2f2f2;margin-top:16px" no-lines>
    <ion-label style="font-size: 15px;color: #bf4080;">Create Account</ion-label>
    <ion-toggle checked="true" [(ngModel)]="form.register" name="subscribe"></ion-toggle>
  </ion-item>

<div *ngIf="form.register"  style="margin: 0px">
<form #f="ngForm">
<ion-list style="margin: 0px">
  <ion-label style="margin:10px 0 0 0;background-color:#f2f2f2;padding:10px">
  Create an account by entering the information below. If you are a returning customer please login at the top of the page.
  </ion-label>
  <ion-item>
    <ion-label floating>password</ion-label>
    <ion-input required type="password" [(ngModel)]="form.password" name="password"></ion-input>
  </ion-item>
</ion-list> 
</form>
</div> 


<ion-list *ngIf="OrderReview">
<ion-item style="background-color:#f2f2f2;margin-top:10px" no-lines>
<ion-label style="font-size: 15px;color: #bf4080;">Your order</ion-label>
</ion-item>

<div *ngFor="let item of OrderReview.cart.cart_contents | keys">
<ion-row>
     <ion-col width-75>
        <ion-label no-margin>{{item.value.data.post.post_name}} - ({{item.value.quantity}})</ion-label>
     </ion-col>
     <ion-col width-25 text-right>
        <ion-label no-margin>{{1*item.value.line_subtotal | currency:values.currency:true:'1.2-2'}}</ion-label>
     </ion-col>
</ion-row>
</div>

<div *ngIf="OrderReview.cart.coupons.length != 0">  
<ion-row> 
     <ion-col width-75>
       <ion-label no-margin>Coupon</ion-label>
     </ion-col>
     <ion-col width-25 text-right>
        <ion-label no-margin> - {{1*OrderReview.cart.discount_cart | currency:values.currency:true:'1.2-2'}}</ion-label>
     </ion-col>
</ion-row>
</div>

<ion-row> 
     <ion-col width-75>
        <ion-label no-margin>Subtotal</ion-label>
     </ion-col>
     <ion-col width-25 text-right>
        <ion-label no-margin>{{1*OrderReview.cart.subtotal | currency:values.currency:true:'1.2-2'}}</ion-label>
     </ion-col>
</ion-row>

<ion-row> 
     <ion-col width-75>
        <ion-label no-margin><b>Total</b></ion-label>
     </ion-col>
     <ion-col width-25 text-right>
        <ion-label no-margin><b>{{1*OrderReview.cart.total | currency:values.currency:true:'1.2-2'}}</b></ion-label>
     </ion-col>
</ion-row>
</ion-list>

<ion-item style="background-color:#f2f2f2;margin-top:16px" no-lines>
   <ion-label style="font-size: 15px;color: #bf4080;">{{values.lan.SelectPaymentMethod}}</ion-label>
</ion-item>

<div *ngIf="form.payment">
<ion-list style="margin:0px" text-wrap radio-group [(ngModel)]="form.payment_method" (ngModelChange)="changePayment()">

      <ion-item *ngFor="let method of form.payment | keys">
        <ion-label style="padding-left:16px">{{method.value.title}}</ion-label>
        <ion-radio value="{{method.value.id}}" ></ion-radio>
      </ion-item>  

</ion-list>

</div>

<div *ngIf="form.payment_method == 'bacs'" class="pay">
<ion-label>{{form.payment.bacs.instructions}}</ion-label>
<br>
<button ion-button color="shadow" [disabled]="buttonSubmit" *ngIf="form.payment_method == 'bacs' || form.payment_method == 'cheque' || form.payment_method == 'cod' " block secondary type="submit" class="button button-block button-default" (click)="checkout()">{{buttonText}}</button>
</div>

<div *ngIf="form.payment_method =='cheque'" class="pay">
<ion-label>{{form.payment.cheque.instructions}}</ion-label>
<br>
<button ion-button color="shadow" [disabled]="buttonSubmit" *ngIf="form.payment_method == 'bacs' || form.payment_method == 'cheque' || form.payment_method == 'cod' " block secondary type="submit" class="button button-block button-default" (click)="checkout()">{{buttonText}}</button>
</div>

<div *ngIf="form.payment_method =='cod'" class="pay">
<ion-label>{{form.payment.cod.instructions}}</ion-label>
<br>
<button ion-button color="shadow" [disabled]="buttonSubmit" *ngIf="form.payment_method == 'bacs' || form.payment_method == 'cheque' || form.payment_method == 'cod' " block secondary type="submit" class="button button-block button-default" (click)="checkout()">{{buttonText}}</button>
</div>

<div *ngIf="form.payment_method =='paypal'" class="pay">
<ion-label>{{form.payment.paypal.description}}</ion-label>
<br>
<button ion-button color="shadow" [disabled]="buttonSubmit" *ngIf="form.payment_method =='paypal'" (click)="checkoutPaypal()" block secondary type="submit" class="button button-block button-default">Proceed to payPal</button>
</div>

<div *ngIf="form.payment_method =='payuindia'" class="pay">
<ion-label>{{form.payment.payuindia.description}}</ion-label>
<br>
<button ion-button color="shadow" *ngIf="form.payment_method =='payuindia'" [disabled]="buttonSubmit" (click)="checkoutPaypal()" block secondary type="submit" class="button button-block button-default">Proceed to PayU Money</button>
</div>

<div *ngIf="form.payment_method =='stripe'" style="margin:0px;background-color:#f2f2f2;padding:10px">
<ion-label [innerHTML]="form.payment.stripe.description"></ion-label>


<form #f="ngForm">
  <ion-list no-margin>
  <ion-item style=" background-color:#f2f2f2"><ion-label style="font-size: 15px; color: #bf4080;"> Stripe Card Details </ion-label></ion-item>
  <ion-item>
    <ion-label floating>Card Number</ion-label>
    <ion-input required type="text" [(ngModel)]="form.stripe_number" name="stripe_number"></ion-input>
  </ion-item>

  <ion-item>
    <ion-label floating>Expiry Month (MM)</ion-label>
    <ion-input required type="text" [(ngModel)]="form.stripe_exp_month" name="stripe_exp_year"></ion-input>
  </ion-item>

  <ion-item>
    <ion-label floating>Expiry Year (YYYY)</ion-label>
    <ion-input required type="text" [(ngModel)]="form.stripe_exp_year" name="stripe_exp_year"></ion-input>
  </ion-item>


  <ion-item>
    <ion-label floating>Card Code</ion-label>
    <ion-input required type="text" [(ngModel)]="form.stripe_code" name="stripe_code"></ion-input>
  </ion-item>
  </ion-list>
</form>

<br>

<button ion-button color="shadow" *ngIf="form.payment_method =='stripe'" [disabled]="buttonSubmit" (click)="checkoutStripe()" block secondary type="submit" class="button button-block button-default">{{buttonText}}</button>


{{error | json}}

</div><br><br>


</div>
</ion-content>